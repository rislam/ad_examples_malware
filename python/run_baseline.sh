#!/bin/bash

N_QUERY=2000
WEIGHTED_UPDATE=0
QUERY_STRATEGY=0
N_RUNS=1
STARTING=0
QUEUE="doppa"
N_PT=0
# DS_NAME='adadroid'

for classifier in KNN SVC DT # LR LRCV RF
do
  for WEIGHTED_UPDATE in 0 1
  do
    for QUERY_STRATEGY in 0 1 5 # 3 4
    do
      for DS_NAME in Adadroid Mamadroid Afonso
      do
        if [ "$QUERY_STRATEGY" -eq 0 ]; then
           query_strategy="us_qs"
        elif [ "$QUERY_STRATEGY" -eq 1 ]; then
           query_strategy="grd_qs"
        elif [ "$QUERY_STRATEGY" -eq 2 ]; then
           query_strategy="dvrs_qs"
        elif [ "$QUERY_STRATEGY" -eq 3 ]; then
            query_strategy="es_qs"
        elif [ "$QUERY_STRATEGY" -eq 4 ]; then
            query_strategy="ms_qs"
        elif [ "$QUERY_STRATEGY" -eq 5 ]; then
            query_strategy="rand_qs"
        fi
        for WITH_FEEDBACK in 0 1
        do
          #greedy_query_strategy-ptrain-fbcount-100-base-LR-starting-0-weighted_update-False-ds-Adadroid-nruns-1.log
          prefix="$query_strategy-pt-$N_PT-fbcount-$N_QUERY-base-$classifier-starting-$STARTING-weighted_update-$WEIGHTED_UPDATE-ds-$DS_NAME-nruns-$N_RUNS-with-fb-${WITH_FEEDBACK}"
          echo $prefix
  #        DIRECTORY="/home/mislam1/icse/ad_examples/python"
          DIRECTORY="/home/mislam1/codebase/bb_python/ad_examples_malware/python"
#          DIRECTORY="/home/rakib/codebase/bb_python/ad_examples_malware/python"
          OUTFILE="$DIRECTORY/$prefix-out.txt"
          ERRORFILE="$DIRECTORY/$prefix-error.txt"
          python -m baseline.malware.baseline_experiments --filedir "" --datafile "~/ad_examples_malware/datasets/anomaly/${DS_NAME}/fullsamples/${DS_NAME}_1.csv" --query_strategy $QUERY_STRATEGY --n_query $N_QUERY --n_runs $N_RUNS --weighted_update $WEIGHTED_UPDATE --starting $STARTING --train_years $N_PT --base_clf $classifier --with_feedback $WITH_FEEDBACK --{DS_NAME}
#          qsub -N "$prefix" -q $QUEUE -l walltime=72:00:00,mem=6gb,nodes=1:doppa:ppn=4 -o $OUTFILE -e $ERRORFILE -j oe -k oe -M mdrakibul.islam@wsu.edu -m bae -v QUERY_STRATEGY=${QUERY_STRATEGY},N_QUERY=${N_QUERY},N_RUNS=${N_RUNS},WEIGHTED_UPDATE=${WEIGHTED_UPDATE},STARTING=${STARTING},DIRECTORY=${DIRECTORY},N_PT=${N_PT},DS_NAME=${DS_NAME},classifier=${classifier},WITH_FEEDBACK=${WITH_FEEDBACK} experiment.sh
        done
      done
    done
  done
done

